CREATE TABLE "usuario" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "documento_identificacion" varchar UNIQUE NOT NULL,
  "nombre" varchar NOT NULL,
  "apellido" varchar NOT NULL,
  "contrasena" varchar NOT NULL
);

CREATE TABLE "rol" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "nombre" varchar NOT NULL
);

CREATE TABLE "usuario_rol" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "id_usuario" integer NOT NULL,
  "id_rol" integer NOT NULL
);

CREATE TABLE "vehiculo" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "id_usuario" integer UNIQUE NOT NULL,
  "id_tipo_vehiculo" integer UNIQUE NOT NULL,
  "placa" varchar NOT NULL
);

CREATE TABLE "tipo_vehiculo" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "nombre" varchar NOT NULL,
  "tarifa" decimal(10,2) NOT NULL
);

CREATE TABLE "parqueadero" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "id_vehiculo" integer UNIQUE,
  "ubicacion" varchar NOT NULL,
  "disponibilidad" bool
);

CREATE TABLE "reserva" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "id_parqueadero" integer NOT NULL,
  "id_vehiculo" integer NOT NULL,
  "hora_entrada" timestamp NOT NULL,
  "estado" varchar
);

CREATE TABLE "tiquete" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "id_vehiculo" integer NOT NULL,
  "hora_entrada" timestamp NOT NULL,
  "hora_salida" timestamp,
  "descuento" decimal(10,2),
  "valor" decimal(10,2)
);

CREATE TABLE "factura" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "valor" decimal(10,2) NOT NULL
);

ALTER TABLE "usuario_rol" ADD FOREIGN KEY ("id_rol") REFERENCES "rol" ("id");

ALTER TABLE "usuario_rol" ADD FOREIGN KEY ("id_usuario") REFERENCES "usuario" ("id");

ALTER TABLE "tiquete" ADD FOREIGN KEY ("id_vehiculo") REFERENCES "vehiculo" ("id");

ALTER TABLE "reserva" ADD FOREIGN KEY ("id_vehiculo") REFERENCES "vehiculo" ("id");

ALTER TABLE "reserva" ADD FOREIGN KEY ("id_parqueadero") REFERENCES "parqueadero" ("id");

ALTER TABLE "parqueadero" ADD FOREIGN KEY ("id_vehiculo") REFERENCES "vehiculo" ("id");

ALTER TABLE "vehiculo" ADD FOREIGN KEY ("id_usuario") REFERENCES "usuario" ("id");

ALTER TABLE "vehiculo" ADD FOREIGN KEY ("id_tipo_vehiculo") REFERENCES "tipo_vehiculo" ("id");

INSERT INTO "usuario" ("documento_identificacion", "nombre", "apellido", "contrasena")
VALUES ('1234567890', 'Juan', 'Pérez', 'contraseña123');

INSERT INTO "tipo_vehiculo" ("nombre", "tarifa")
VALUES ('Automóvil', 10.50);

INSERT INTO "vehiculo" ("id_usuario", "id_tipo_vehiculo", "placa")
VALUES (1, 1, 'ABC123');

INSERT INTO "parqueadero" ("id_vehiculo", "ubicacion", "disponibilidad")
VALUES (1, 'Piso 1, Espacio 10', true);

SELECT * FROM "usuario"
	
SELECT * FROM "tipoVehiculo"

SELECT * FROM "vehiculo"

SELECT * FROM "parqueadero"