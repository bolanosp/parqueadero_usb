CREATE TABLE "usuario" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "documentoIdentificacion" varchar UNIQUE NOT NULL,
  "nombre" varchar NOT NULL,
  "apellido" varchar NOT NULL,
  "contrasena" varchar NOT NULL
);

CREATE TABLE "rol" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "nombre" varchar NOT NULL
);

CREATE TABLE "usuarioRol" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "idUsuario" integer NOT NULL,
  "idRol" integer NOT NULL
);

CREATE TABLE "vehiculo" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "idUsuario" integer UNIQUE NOT NULL,
  "idTipoVehiculo" integer UNIQUE NOT NULL,
  "placa" varchar NOT NULL
);

CREATE TABLE "tipoVehiculo" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "nombre" varchar NOT NULL,
  "tarifa" decimal(10,2) NOT NULL
);

CREATE TABLE "parqueadero" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "idVehiculo" integer UNIQUE,
  "ubicacion" varchar NOT NULL,
  "disponibilidad" bool
);

CREATE TABLE "reserva" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "idParqueadero" integer NOT NULL,
  "idVehiculo" integer NOT NULL,
  "horaEntrada" timestamp NOT NULL,
  "estado" varchar
);

CREATE TABLE "tiquete" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "idVehiculo" integer NOT NULL,
  "horaEntrada" timestamp NOT NULL,
  "horaSalida" timestamp,
  "descuento" decimal(10,2),
  "valor" decimal(10,2)
);

CREATE TABLE "factura" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "valor" decimal(10,2) NOT NULL
);

ALTER TABLE "usuarioRol" ADD FOREIGN KEY ("idRol") REFERENCES "rol" ("id");

ALTER TABLE "usuario" ADD FOREIGN KEY ("id") REFERENCES "usuarioRol" ("id");

ALTER TABLE "tiquete" ADD FOREIGN KEY ("id") REFERENCES "vehiculo" ("id");

ALTER TABLE "reserva" ADD FOREIGN KEY ("idVehiculo") REFERENCES "vehiculo" ("id");

ALTER TABLE "reserva" ADD FOREIGN KEY ("idParqueadero") REFERENCES "parqueadero" ("id");

ALTER TABLE "vehiculo" ADD FOREIGN KEY ("id") REFERENCES "parqueadero" ("idVehiculo");

ALTER TABLE "vehiculo" ADD FOREIGN KEY ("idUsuario") REFERENCES "usuario" ("id");

ALTER TABLE "tipoVehiculo" ADD FOREIGN KEY ("id") REFERENCES "vehiculo" ("idTipoVehiculo");
